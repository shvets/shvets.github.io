<!doctype html>
<html lang='en'>
<head>
<!-- Always force latest IE rendering engine or request Chrome Frame -->
<meta content='IE=edge,chrome=1' http-equiv='X-UA-Compatible'>
<meta content='text/html; charset=utf-8' http-equiv='Content-type'>
<meta content="GitHub --- Alexander Shvets's Web Page" name='description'>
<meta content='github, ruby, java, rails' name='keywords'>
<title>GitHub --- Alexander Shvets's Web Page</title>
<link href="/assets/stylesheets/screen.css" media="screen" rel="stylesheet" type="text/css" />
<script src="/assets/javascripts/application.js" type="text/javascript"></script>
</head>
<body>
<div id='wrapper'>
<div id='main-column'>
<div id='logo'>
<h1>
<a href='/'>Alexander Shvets GitHub Home Page</a>
</h1>

</div>
<div id='menu'>
<ul>
<li class='current_page_item'>
<a href='/index.html'>Projects</a>
</li>
<li class='current_page_item'>
<a href='/bookmarks/index.html'>Bookmarks</a>
</li>
<li class='current_page_item'>
<a href='/blog/index.html'>Blog</a>
</li>
</ul>

</div>
<div id='page'>
<h1>Using Node.js and Karma Framework for Unit Tests and Code Coverage in Javascript</h1>

<p>Your web project, whether it&rsquo;s written in Java, Python or Ruby, has Javascript files that
support front-end part of it. And unit tests and code coverage for them are two most
<strong>uncovered</strong> areas, <strong>terra incognito</strong> of Javascript world.</p>

<p>New technologies, such as <strong>Node.js</strong>, can help you to <strong>cover</strong> it. Node.js is server-side technology, but
we don&rsquo;t plan to change the way we use Javascript in today&rsquo;s projects, we just use Node.js as complimentary
tool for packages delivery and execution of code, that is located outside of your project,
such as unit-test runner or coverage runner.</p>

<p>Because this technology is orthogonal to your project, it can be used in virtually any project,
whether it&rsquo;s PHP, Java, Ruby or C#, as long as they have Javascript.</p>

<p>Writing unit tests and generating code coverage is superior to your project, because having unit tests
<strong>increases quality</strong> of code and code coverage report provides <strong>awareness</strong> and <strong>better control</strong>
of what is going on with the project.</p>

<h2>Node.js: what it is?</h2>

<ul>
<li><p>It was created by <strong>Ryan Dahl</strong> in 2009.</p></li>
<li><p>It is <strong>scripting language</strong> - no compilation required, convenient for writing automation scripts. It uses
Google Chrome v8 Javascript engine.</p></li>
<li><p>It is Javascript that&rsquo;s <strong>freed from the browser&rsquo;s chains</strong> - it can be used from <strong>command line</strong> and as
part of <strong>server-side</strong> collection of technologies.</p></li>
<li><p>It has a lot of <strong>packages</strong> (libraries) for easy extending existing functionality. You use <strong>node package manager</strong>
to deliver node packages to your computer same way as Ruby developers use RubyGems for downloading gems
(Ruby equivalent of library).</p></li>
<li><p>It is <strong>technology-in-demand</strong>. Some companies that use it: <strong>github.com</strong>,  <strong>linkedin.com</strong>,
<strong>vonage.com</strong>, <strong>ebay.com</strong>, <strong>microsoft.com</strong>, <strong>trello.com</strong>.</p></li>
<li><p>It is <strong>new and promising technology</strong>. See <a href="http://www.dragoninnovation.com/projects/22-tesselâ€Ž">Tessel</a> -
internet-connected microcontroller progammable in Node.js.</p></li>
<li><p>A lot of hosting services already support Node.js: <strong>Heroku</strong>, <strong>Joyent</strong>, <strong>CloudFoundry</strong>, <strong>OpenShift</strong>, <strong>Cloudnode</strong>,
<strong>WindowsAzure</strong>.</p></li>
</ul>

<h2>Installation</h2>

<p>If you are on Apple computer, you can use <strong>homebrew</strong> tool to install it:</p>
<pre class="highlight shell"><table><tbody><tr><td class="gutter gl"><div class="lineno">1</div></td><td class="code">brew install node
</td></tr></tbody></table></pre>
<p>It will install <strong>node package manager</strong> (npm) as well:</p>
<pre class="highlight shell"><table><tbody><tr><td class="gutter gl"><div class="lineno">1</div><div class="lineno">2</div></td><td class="code">node -v
npm -v
</td></tr></tbody></table></pre>
<p>On Windows you can download node and npm as one installation from <a href="http://nodejs.org/download">here</a>.</p>

<h2>Using Node.js: Webserver example</h2>

<p>Let&rsquo;s demonstrate &ldquo;hello world&rdquo; program for Node.js. This simple web server responds with &ldquo;Hello World&rdquo; string
for every request.</p>
<pre class="highlight javascript"><table><tbody><tr><td class="gutter gl"><div class="lineno">1</div><div class="lineno">2</div><div class="lineno">3</div><div class="lineno">4</div><div class="lineno">5</div><div class="lineno">6</div><div class="lineno">7</div><div class="lineno">8</div><div class="lineno">9</div><div class="lineno">10</div><div class="lineno">11</div><div class="lineno">12</div></td><td class="code"><span class="c1">// hello_world.js
</span>
<span class="kd">var</span> <span class="nx">http</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'http'</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">server</span> <span class="o">=</span> <span class="nx">http</span><span class="p">.</span><span class="nx">createServer</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">writeHead</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="p">{</span><span class="s1">'Content-Type'</span><span class="err">:</span> <span class="s1">'text/plain'</span><span class="p">});</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="s1">'Hello World\n'</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">server</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="mi">1337</span><span class="p">,</span> <span class="s1">'127.0.0.1'</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Server running at http://127.0.0.1:1337/'</span><span class="p">);</span>
</td></tr></tbody></table></pre>
<p>To run this code, execute it from the command line:</p>
<pre class="highlight shell"><table><tbody><tr><td class="gutter gl"><div class="lineno">1</div><div class="lineno">2</div><div class="lineno">3</div></td><td class="code"><span class="gp">% </span>node example.js

Server running at http://127.0.0.1:1337/
</td></tr></tbody></table></pre>
<h2>Installing node packages</h2>

<p>You can install node packages in two ways:</p>

<ul>
<li><p><strong>globally</strong>, for all projects: usually in <strong>/usr/local//lib/node_modules</strong>;</p></li>
<li><p><strong>locally</strong>, for current project only: in <strong>your<em>project</em>root/node_modules</strong>;</p></li>
</ul>

<p>This is the example of global installation:</p>
<pre class="highlight shell"><table><tbody><tr><td class="gutter gl"><div class="lineno">1</div></td><td class="code">npm install -g grunt-cli
</td></tr></tbody></table></pre>
<p>and local installation:</p>
<pre class="highlight shell"><table><tbody><tr><td class="gutter gl"><div class="lineno">1</div></td><td class="code">npm install grunt-cli
</td></tr></tbody></table></pre>
<p>In examples above we are installing <strong>grunt</strong> build tool.</p>

<p>Saving packages locally is <a href="http://www.futurealoof.com/posts/nodemodules-in-git.html">good practice</a> -
this way you will have the ability to quickly reproduce your production environment -
<a href="http://www.12factor.net/dev-prod-parity">dev/prod parity</a>.</p>

<p>You can execute grunt command now:</p>
<pre class="highlight shell"><table><tbody><tr><td class="gutter gl"><div class="lineno">1</div><div class="lineno">2</div><div class="lineno">3</div></td><td class="code"><span class="nb">cd </span>your_project_root

node_modules/grunt-cli/bin/grunt -version
</td></tr></tbody></table></pre>
<h2>Keep track of node packages used by project</h2>

<p>You can create <strong>package.json</strong> file used by <strong>npm</strong> to keep track of project dependencies. This is
sample file:</p>
<pre class="highlight json"><table><tbody><tr><td class="gutter gl"><div class="lineno">1</div><div class="lineno">2</div><div class="lineno">3</div><div class="lineno">4</div><div class="lineno">5</div><div class="lineno">6</div><div class="lineno">7</div><div class="lineno">8</div><div class="lineno">9</div><div class="lineno">10</div><div class="lineno">11</div><div class="lineno">12</div><div class="lineno">13</div><div class="lineno">14</div><div class="lineno">15</div></td><td class="code"><span class="p">{</span><span class="w">
  </span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;your_project&quot;</span><span class="p">,</span><span class="w">
  </span><span class="s2">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span><span class="w">
  </span><span class="s2">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Npm package for your_project&quot;</span><span class="p">,</span><span class="w">
  </span><span class="s2">&quot;author&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;John Smith &lt;jsmith@site.com&gt;&quot;</span><span class="p">,</span><span class="w">
  </span><span class="s2">&quot;engines&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">&quot;node&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&gt;= 0.10.16&quot;</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">&quot;dependencies&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
  </span><span class="s2">&quot;devDependencies&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">&quot;grunt&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;~0.4.1&quot;</span><span class="p">,</span><span class="w">
    </span><span class="s2">&quot;grunt-cli&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;~0.1.9&quot;</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></td></tr></tbody></table></pre>
<p>With this file in place you can install all required dependencies (grunt, grunt-cli) in one command:</p>
<pre class="highlight shell"><table><tbody><tr><td class="gutter gl"><div class="lineno">1</div></td><td class="code">npm install
</td></tr></tbody></table></pre>
<p>You can also install single package with automatic insert of package name/description into <strong>package.json</strong>
as development dependency:</p>
<pre class="highlight shell"><table><tbody><tr><td class="gutter gl"><div class="lineno">1</div></td><td class="code">npm install grunt-cli --save-dev
</td></tr></tbody></table></pre>
<h2>Look: identical tools for different languages</h2>

<p>If we look at different languages as frameworks, we can see that most of them have similar tools for similar needs.</p>

<p>For example,</p>

<ul>
<li><p>build tool:</p>

<ul>
<li>Java - Ant/Maven</li>
<li>Ruby - rake/thor</li>
<li>Node - grunt</li>
</ul></li>
<li><p>package manager:</p>

<ul>
<li>Java - ??? (maybe Maven?)</li>
<li>Ruby - gem</li>
<li>Node - npm</li>
</ul></li>
<li><p>dependencies resolver:</p>

<ul>
<li>Java - Maven</li>
<li>Ruby - bundler</li>
<li>Node - npm</li>
</ul></li>
<li><p>version manager:</p>

<ul>
<li>Java - no</li>
<li>Ruby - rvm</li>
<li>Node - nvm</li>
</ul></li>
</ul>

<p>Looks like it&rsquo;s becoming <strong>de-facto standard</strong> for contemporary popular languages to have
at least some <strong>package delivery engine</strong>, <strong>dependencies resolver</strong> and <strong>framework version manager</strong>.</p>

<h2>Karma Framework: what is it?</h2>

<p>We use Node.js primarily as <strong>delivery mechanism</strong> for easy installation of packages that will help
us to build <strong>unit tests</strong> and generate <strong>code coverage</strong>. This can be done by <strong>Karma</strong> framework.</p>

<ul>
<li><p>It was created by <strong>AngularJS</strong> team.</p></li>
<li><p>It&rsquo;s <strong>not</strong> unit test or coverage library - it&rsquo;s universal <strong>layer built on top</strong> of existing testing/coverage
libraries <strong>with common configuration</strong>.</p></li>
<li><p>It&rsquo;s <strong>agnostic to testing framework</strong>: you describe your tests with Jasmine, Mocha, QUnit, or write a simple
adapter for any framework you like.</p></li>
<li><p>You can plug in coverage library seamlessly.</p></li>
<li><p>You can test <strong>same code in different browsers</strong> simultaneously.</p></li>
<li><p>You can <strong>debug</strong> with the help of RubyMine/WebStorm IDEs, Chrome or Firefox browsers.</p></li>
<li><p>You can run your tests in <strong>headless mode</strong> with the help of <strong>PhantomJS</strong> library.</p></li>
</ul>

<h2>Installation</h2>

<p>You can install karma through <strong>npm</strong>:</p>
<pre class="highlight shell"><table><tbody><tr><td class="gutter gl"><div class="lineno">1</div></td><td class="code">npm install karma --save-dev
</td></tr></tbody></table></pre>
<p>After <strong>karma</strong> installation you need to create <strong>karma configuration file</strong>.</p>

<p>You can keep it in javascript:</p>
<pre class="highlight shell"><table><tbody><tr><td class="gutter gl"><div class="lineno">1</div></td><td class="code">node_modules/karma/bin/karma init karma.conf.js
</td></tr></tbody></table></pre>
<p>or coffeescript:</p>
<pre class="highlight shell"><table><tbody><tr><td class="gutter gl"><div class="lineno">1</div></td><td class="code">node_modules/karma/bin/karma init karma.conf.coffee
</td></tr></tbody></table></pre>
<p>Script will ask few questions and at the end <strong>karma.conf.js</strong> or <strong>karma.conf.coffee</strong> file will be created.</p>

<p>Now, you need to install additional packages. First, install browser launchers and preprocessors:</p>
<pre class="highlight shell"><table><tbody><tr><td class="gutter gl"><div class="lineno">1</div><div class="lineno">2</div><div class="lineno">3</div><div class="lineno">4</div><div class="lineno">5</div><div class="lineno">6</div><div class="lineno">7</div></td><td class="code">npm install karma-chrome-launcher --save-dev
npm install karma-firefox-launcher --save-dev
npm install karma-safari-launcher --save-dev
npm install karma-phantomjs-launcher --save-dev

npm install karma-coffee-preprocessor --save-dev
npm install karma-html2js-preprocessor --save-dev
</td></tr></tbody></table></pre>
<p>Then, install support for jasmine (it&rsquo;s one of supported testing libraries):</p>
<pre class="highlight shell"><table><tbody><tr><td class="gutter gl"><div class="lineno">1</div></td><td class="code">npm install karma-jasmine --save-dev
</td></tr></tbody></table></pre>
<h2>Revisiting Content of Karma Configuration File</h2>

<p>Below is the typical example of karma configuration file:</p>
<pre class="highlight coffeescript"><table><tbody><tr><td class="gutter gl"><div class="lineno">1</div><div class="lineno">2</div><div class="lineno">3</div><div class="lineno">4</div><div class="lineno">5</div><div class="lineno">6</div><div class="lineno">7</div><div class="lineno">8</div><div class="lineno">9</div><div class="lineno">10</div><div class="lineno">11</div><div class="lineno">12</div><div class="lineno">13</div><div class="lineno">14</div><div class="lineno">15</div><div class="lineno">16</div><div class="lineno">17</div><div class="lineno">18</div><div class="lineno">19</div><div class="lineno">20</div><div class="lineno">21</div><div class="lineno">22</div><div class="lineno">23</div><div class="lineno">24</div><div class="lineno">25</div><div class="lineno">26</div><div class="lineno">27</div><div class="lineno">28</div><div class="lineno">29</div><div class="lineno">30</div><div class="lineno">31</div><div class="lineno">32</div><div class="lineno">33</div><div class="lineno">34</div><div class="lineno">35</div><div class="lineno">36</div><div class="lineno">37</div><div class="lineno">38</div><div class="lineno">39</div><div class="lineno">40</div><div class="lineno">41</div><div class="lineno">42</div><div class="lineno">43</div><div class="lineno">44</div><div class="lineno">45</div><div class="lineno">46</div><div class="lineno">47</div><div class="lineno">48</div></td><td class="code"><span class="c1"># karma.conf.coffee
</span>
<span class="nx">module</span><span class="p">.</span><span class="na">exports</span> <span class="o">=</span> <span class="p">(</span><span class="nx">config</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="nx">config</span><span class="p">.</span><span class="na">set</span>
    <span class="na">basePath</span><span class="o">:</span> <span class="s">'.'</span>

    <span class="na">frameworks</span><span class="o">:</span> <span class="p">[</span><span class="s">'jasmine'</span><span class="p">]</span>

    <span class="na">files</span><span class="o">:</span> <span class="p">[</span>
      <span class="c1"># external libraries
</span>
      <span class="nx">process</span><span class="p">.</span><span class="na">env</span><span class="p">.</span><span class="na">GEM_HOME</span> <span class="o">+</span>
        <span class="s">'/gems/jquery-rails-3.0.4/vendor/assets/javascripts/jquery.js'</span>

      <span class="c1"># project libraries
</span>
      <span class="s">'app/assets/javascripts/*.js'</span><span class="p">,</span>
      <span class="s">'app/assets/javascripts/*.coffee'</span><span class="p">,</span>

      <span class="c1"># specs
</span>
      <span class="p">{</span><span class="na">pattern</span><span class="o">:</span> <span class="s">'spec/javascripts/*_spec.js'</span><span class="p">,</span> <span class="na">included</span><span class="o">:</span> <span class="no">true</span><span class="p">}</span>
      <span class="p">{</span><span class="na">pattern</span><span class="o">:</span> <span class="s">'spec/javascripts/*_spec.coffee'</span><span class="p">,</span> <span class="na">included</span><span class="o">:</span> <span class="no">true</span><span class="p">}</span>
    <span class="p">]</span>

    <span class="c1"># list of files to exclude
</span>    <span class="na">exclude</span><span class="o">:</span> <span class="p">[]</span>

    <span class="na">preprocessors</span><span class="o">:</span>
      <span class="s">'**/*.coffee'</span><span class="o">:</span> <span class="p">[</span><span class="s">'coffee'</span><span class="p">]</span>

    <span class="na">reporters</span><span class="o">:</span> <span class="p">[</span><span class="s">'dots'</span><span class="p">]</span>

    <span class="na">port</span><span class="o">:</span> <span class="mi">9876</span>

    <span class="na">colors</span><span class="o">:</span> <span class="no">true</span>

    <span class="na">logLevel</span><span class="o">:</span> <span class="nx">config</span><span class="p">.</span><span class="na">LOG_INFO</span>

    <span class="na">autoWatch</span><span class="o">:</span> <span class="no">false</span>

    <span class="na">browsers</span><span class="o">:</span> <span class="p">[</span><span class="s">&quot;PhantomJS&quot;</span><span class="p">]</span>

    <span class="na">captureTimeout</span><span class="o">:</span> <span class="mi">60000</span>

    <span class="na">singleRun</span><span class="o">:</span> <span class="no">true</span>

    <span class="na">reportSlowerThan</span><span class="o">:</span> <span class="mi">500</span>
</td></tr></tbody></table></pre>
<p>Let&rsquo;s explain some of used properties.</p>

<ul>
<li><p><strong>basePath</strong> points to the root of your project</p></li>
<li><p><strong>frameworks</strong> describes used frameworks (we use jasmine only)</p></li>
<li><p><strong>files</strong> should include</p>

<ul>
<li>original javascript code to be tested</li>
<li>dependent external libraries</li>
<li>specs</li>
<li>fixtures (if yop plan to use them)</li>
</ul></li>
<li><p><strong>preprocessors</strong> describe different actions/filters. Some of them:</p>

<ul>
<li>how to process coffeescript files (coffee);</li>
<li>how to build fixtures (html2js);</li>
<li>what files to include into code coverage (coverage);</li>
</ul></li>
<li><p><strong>reporters</strong> define usage of &ldquo;dots&rdquo; reporter</p></li>
<li><p><strong>browsers</strong> describe in which browsers code should be tested. We use <strong>PhantomJS</strong> for headless tests</p></li>
<li><p><strong>singleRun</strong>: true is useful for running in CI server</p></li>
</ul>

<h2>Using Karma</h2>

<p>You can start karma with this command:</p>
<pre class="highlight shell"><table><tbody><tr><td class="gutter gl"><div class="lineno">1</div></td><td class="code">node_modules/karma/bin/karma start
</td></tr></tbody></table></pre>
<p>This command will run all specs in <strong>spec/javascripts</strong> folder and output results to console.</p>
<pre class="highlight shell"><table><tbody><tr><td class="gutter gl"><div class="lineno">1</div><div class="lineno">2</div><div class="lineno">3</div><div class="lineno">4</div><div class="lineno">5</div></td><td class="code">INFO <span class="o">[</span>karma]: Karma v0.10.2 server started at http://localhost:9876/
INFO <span class="o">[</span>launcher]: Starting browser PhantomJS
INFO <span class="o">[</span>PhantomJS 1.9.1 <span class="o">(</span>Mac OS X<span class="o">)]</span>: Connected on socket _juBSCUpZSBdU1wA-URx
...............................................
PhantomJS 1.9.1 <span class="o">(</span>Mac OS X<span class="o">)</span>: Executed 47 of 47 SUCCESS <span class="o">(</span>0.167 secs / 0.027 secs<span class="o">)</span>
</td></tr></tbody></table></pre>
<h2>Code Coverage with Karma</h2>

<p>For generating code coverage report you have to install <strong>karma-coverage</strong> package:</p>
<pre class="highlight shell"><table><tbody><tr><td class="gutter gl"><div class="lineno">1</div></td><td class="code">npm install karma-coverage --save-dev
</td></tr></tbody></table></pre>
<p>You also have to register your javascript or coffeescript files with <strong>coverage</strong> preprocessor,
add <strong>coverage</strong> reporter to the list of reporters and create <strong>coverageReporter</strong> section:</p>
<pre class="highlight coffeescript"><table><tbody><tr><td class="gutter gl"><div class="lineno">1</div><div class="lineno">2</div><div class="lineno">3</div><div class="lineno">4</div><div class="lineno">5</div><div class="lineno">6</div><div class="lineno">7</div><div class="lineno">8</div><div class="lineno">9</div><div class="lineno">10</div><div class="lineno">11</div><div class="lineno">12</div><div class="lineno">13</div><div class="lineno">14</div><div class="lineno">15</div></td><td class="code"><span class="c1"># karma.conf.coffee
</span><span class="nx">module</span><span class="p">.</span><span class="na">exports</span> <span class="o">=</span> <span class="p">(</span><span class="nx">config</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="nx">config</span><span class="p">.</span><span class="na">set</span>
    <span class="p">...</span>

    <span class="na">preprocessors</span><span class="o">:</span>
      <span class="s">'app/assets/javascripts/**/*.js'</span><span class="o">:</span> <span class="p">[</span><span class="s">'coverage'</span><span class="p">]</span>
      <span class="s">'app/assets/javascripts/**/*.coffee'</span><span class="o">:</span> <span class="p">[</span><span class="s">'coverage'</span><span class="p">]</span>

    <span class="na">reporters</span><span class="o">:</span> <span class="p">[</span><span class="s">'dots'</span><span class="p">,</span> <span class="s">'coverage'</span><span class="p">]</span>

    <span class="na">coverageReporter</span><span class="o">:</span>
      <span class="na">type</span><span class="o">:</span> <span class="s">'html'</span>
      <span class="na">dir</span><span class="o">:</span> <span class="s">'coverage'</span>
    <span class="p">...</span>
</td></tr></tbody></table></pre>
<p><strong>coverageReporter</strong> section describes configuration of &ldquo;coverage&rdquo; reporter: type of report and location of it.</p>

<p>Now, when you run karma again</p>
<pre class="highlight shell"><table><tbody><tr><td class="gutter gl"><div class="lineno">1</div></td><td class="code">node_modules/karma/bin/karma start
</td></tr></tbody></table></pre>
<p>it will create coverage report inside <strong>coverage</strong> directory. Open it:</p>
<pre class="highlight shell"><table><tbody><tr><td class="gutter gl"><div class="lineno">1</div></td><td class="code">open coverage/PhantomJS<span class="se">\ </span>1.9.1<span class="se">\ \(</span>Mac<span class="se">\ </span>OS<span class="se">\ </span>X<span class="se">\)</span>/
</td></tr></tbody></table></pre>
<h2>Using fixture for your specs</h2>

<p>If you plan to use fixtures inside your specs, you have to do these steps.</p>

<ul>
<li>Create fixture file in <strong>fixtures</strong> folder:</li>
</ul>
<pre class="highlight html"><table><tbody><tr><td class="gutter gl"><div class="lineno">1</div><div class="lineno">2</div></td><td class="code"><span class="c">&lt;!-- spec/javascripts/fixtures/template.html --&gt;</span>
<span class="nt">&lt;div&gt;</span>something<span class="nt">&lt;/div&gt;</span>
</td></tr></tbody></table></pre>
<ul>
<li>Add fixtures location to <strong>files</strong> sections and specify <strong>html2js</strong> preprocessor for
html files inside <strong>fixtures</strong> directory:</li>
</ul>
<pre class="highlight coffeescript"><table><tbody><tr><td class="gutter gl"><div class="lineno">1</div><div class="lineno">2</div><div class="lineno">3</div><div class="lineno">4</div><div class="lineno">5</div><div class="lineno">6</div><div class="lineno">7</div><div class="lineno">8</div><div class="lineno">9</div><div class="lineno">10</div><div class="lineno">11</div><div class="lineno">12</div><div class="lineno">13</div><div class="lineno">14</div></td><td class="code"><span class="c1"># karma.conf.coffee
</span><span class="nx">module</span><span class="p">.</span><span class="na">exports</span> <span class="o">=</span> <span class="p">(</span><span class="nx">config</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="nx">config</span><span class="p">.</span><span class="na">set</span>
    <span class="p">...</span>

    <span class="na">files</span><span class="o">:</span> <span class="p">[</span>
      <span class="p">...</span>
      <span class="s">'spec/javascripts/fixtures/**/*.html'</span>
    <span class="p">]</span>

    <span class="na">preprocessors</span><span class="o">:</span>
      <span class="s">'spec/javascripts/fixtures/**/*.html'</span><span class="o">:</span> <span class="p">[</span><span class="s">'html2js'</span><span class="p">]</span>

    <span class="p">...</span>
</td></tr></tbody></table></pre>
<ul>
<li>Access <strong>fixture</strong> from the spec through global <strong>window.__html__</strong> variable:</li>
</ul>
<pre class="highlight coffeescript"><table><tbody><tr><td class="gutter gl"><div class="lineno">1</div><div class="lineno">2</div><div class="lineno">3</div><div class="lineno">4</div><div class="lineno">5</div><div class="lineno">6</div><div class="lineno">7</div><div class="lineno">8</div><div class="lineno">9</div><div class="lineno">10</div><div class="lineno">11</div></td><td class="code"><span class="c1"># spec/javascripts/some_coffee_spec.coffee
</span><span class="nx">describe</span> <span class="s">'some_coffee_code'</span><span class="p">,</span> <span class="o">-&gt;</span>
  <span class="nx">fixture</span> <span class="o">=</span> <span class="no">undefined</span>

  <span class="nx">beforeEach</span> <span class="o">-&gt;</span>
    <span class="nb">window</span><span class="p">.</span><span class="na">__html__</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="na">__html__</span> <span class="o">||</span> <span class="p">{};</span>
    <span class="nx">fixture</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="na">__html__</span><span class="p">[</span><span class="s">'spec/javascripts/fixtures/template.html'</span><span class="p">]</span>

  <span class="nx">it</span> <span class="s">'access div element'</span><span class="p">,</span> <span class="o">-&gt;</span>
    <span class="nx">el</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">fixture</span><span class="p">).</span><span class="na">find</span><span class="p">(</span><span class="s">'#div'</span><span class="p">)</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">el</span><span class="p">).</span><span class="na">toBeDefined</span><span class="p">()</span>
</td></tr></tbody></table></pre>
<div id='footer'>
<p id='legal'>
&copy; All Right Reserved (2013), Alexander Shvets.
Built with
<a href='http://middlemanapp.com'>middleman</a>
Get feed
<a href='/feed.xml'>here</a>
</p>

</div>
</div>
</div>
</div>
<div id='sidebar'>
<div class='section'>
<h2>By Year</h2>
<ol>
<li>
<a href="../../../2014.html">2014</a>
(1)
</li>
<li>
<a href="../../../2013.html">2013</a>
(15)
</li>
<li>
<a href="../../../2012.html">2012</a>
(1)
</li>
<li>
<a href="../../../2011.html">2011</a>
(1)
</li>
</ol>
</div>
<div class='section'>
<h2>Tags</h2>
<ol>
<li>
<a href="../../../tags/ruby.html">ruby</a>
(13)
</li>
<li>
<a href="../../../tags/jruby.html">jruby</a>
(2)
</li>
<li>
<a href="../../../tags/rubymine.html">rubymine</a>
(1)
</li>
<li>
<a href="../../../tags/nanoc.html">nanoc</a>
(1)
</li>
<li>
<a href="../../../tags/coffeescript.html">coffeescript</a>
(1)
</li>
<li>
<a href="../../../tags/bundler.html">bundler</a>
(1)
</li>
<li>
<a href="../../../tags/nodejs.html">nodejs</a>
(2)
</li>
<li>
<a href="../../../tags/javascript.html">javascript</a>
(2)
</li>
<li>
<a href="../../../tags/karma.html">karma</a>
(1)
</li>
<li>
<a href="../../../tags/code-coverage.html">code coverage</a>
(1)
</li>
<li>
<a href="../../../tags/commonjs.html">commonjs</a>
(1)
</li>
<li>
<a href="../../../tags/requirejs.html">requirejs</a>
(1)
</li>
<li>
<a href="../../../tags/sinatra.html">sinatra</a>
(1)
</li>
<li>
<a href="../../../tags/vegas.html">vegas</a>
(1)
</li>
<li>
<a href="../../../tags/launchy.html">launchy</a>
(1)
</li>
<li>
<a href="../../../tags/lunchy.html">lunchy</a>
(1)
</li>
<li>
<a href="../../../tags/rvm.html">rvm</a>
(1)
</li>
<li>
<a href="../../../tags/capybara.html">capybara</a>
(1)
</li>
<li>
<a href="../../../tags/selenium.html">selenium</a>
(1)
</li>
<li>
<a href="../../../tags/webkit.html">webkit</a>
(1)
</li>
<li>
<a href="../../../tags/phantomjs.html">phantomjs</a>
(1)
</li>
<li>
<a href="../../../tags/qt.html">qt</a>
(1)
</li>
<li>
<a href="../../../tags/acceptance-tests.html">acceptance tests</a>
(1)
</li>
<li>
<a href="../../../tags/simplecov.html">simplecov</a>
(1)
</li>
<li>
<a href="../../../tags/ci.html">CI</a>
(1)
</li>
<li>
<a href="../../../tags/webmock.html">webmock</a>
(1)
</li>
<li>
<a href="../../../tags/dsl.html">dsl</a>
(1)
</li>
<li>
<a href="../../../tags/zip.html">zip</a>
(1)
</li>
<li>
<a href="../../../tags/java.html">java</a>
(1)
</li>
<li>
<a href="../../../tags/jar.html">jar</a>
(1)
</li>
<li>
<a href="../../../tags/rake.html">rake</a>
(1)
</li>
<li>
<a href="../../../tags/thor.html">thor</a>
(1)
</li>
<li>
<a href="../../../tags/capistrano.html">capistrano</a>
(1)
</li>
<li>
<a href="../../../tags/chef.html">chef</a>
(1)
</li>
<li>
<a href="../../../tags/osx.html">osx</a>
(1)
</li>
<li>
<a href="../../../tags/mavericks.html">mavericks</a>
(1)
</li>
</ol>
</div>

</div>
</body>
</html>
